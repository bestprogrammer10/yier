<!-- 记账小程序登录首页 -->
<!-- 设计理念：简洁、安全、温暖 -->
<view class="login-container">
  <!-- 背景装饰 -->
  <view class="bg-decoration"></view>

  <!-- 主要内容区域 -->
  <view class="content-wrapper">
    <!-- Logo和应用名称 -->
    <view class="header-section">
      <view class="app-logo">
        <image src="/assets/images/logo.png" mode="aspectFit" class="logo-image"></image>
        <view class="logo-placeholder">💰</view>
      </view>
      <text class="app-name">智记账</text>
      <text class="app-slogan">让每一笔账目都清晰明了</text>
    </view>

    <!-- 登录表单区域 -->
    <view class="form-section">
      <!-- 登录方式切换 -->
      <view class="login-tabs">
        <view
          class="tab-item {{activeTab === 'wechat' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="wechat"
        >
          <text class="tab-icon">🟢</text>
          <text class="tab-text">微信登录</text>
        </view>
        <view
          class="tab-item {{activeTab === 'phone' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="phone"
        >
          <text class="tab-icon">📱</text>
          <text class="tab-text">手机号登录</text>
        </view>
      </view>

      <!-- 微信登录方式 -->
      <view class="login-method wechat-method" wx:if="{{activeTab === 'wechat'}}">
        <view class="wechat-info">
          <text class="info-text">一键授权，快速登录</text>
          <text class="info-subtext">安全便捷，无需记忆密码</text>
        </view>

        <button
          class="wechat-login-btn"
          open-type="getUserInfo"
          bindgetuserinfo="handleWechatLogin"
          loading="{{loading}}"
        >
          <text class="btn-icon">🟢</text>
          <text>微信一键登录</text>
        </button>

        <view class="privacy-agreement">
          <checkbox-group bindchange="togglePrivacy">
            <label class="privacy-label">
              <checkbox value="agree" checked="{{privacyAgreed}}" color="#2E5BFF" />
              <text>我已阅读并同意</text>
              <text class="link" bindtap="showPrivacy">《用户协议》</text>
              <text>和</text>
              <text class="link" bindtap="showPolicy">《隐私政策》</text>
            </label>
          </checkbox-group>
        </view>
      </view>

      <!-- 手机号登录方式 -->
      <view class="login-method phone-method" wx:if="{{activeTab === 'phone'}}">
        <view class="input-group">
          <view class="input-item">
            <text class="input-label">手机号</text>
            <view class="input-wrapper">
              <input
                type="number"
                placeholder="请输入11位手机号"
                value="{{phone}}"
                bindinput="handlePhoneInput"
                maxlength="11"
                class="input-field"
              />
              <view
                class="clear-btn {{phone ? 'show' : ''}}"
                bindtap="clearPhone"
              >✕</view>
            </view>
          </view>

          <view class="input-item">
            <text class="input-label">验证码</text>
            <view class="input-wrapper code-wrapper">
              <input
                type="number"
                placeholder="请输入6位验证码"
                value="{{code}}"
                bindinput="handleCodeInput"
                maxlength="6"
                class="input-field"
              />
              <button
                class="code-btn {{canSendCode ? '' : 'disabled'}}"
                bindtap="sendCode"
                disabled="{{!canSendCode}}"
              >
                {{codeText}}
              </button>
            </view>
          </view>
        </view>

        <button
          class="login-btn {{canLogin ? 'active' : ''}}"
          bindtap="handlePhoneLogin"
          disabled="{{!canLogin}}"
          loading="{{loading}}"
        >
          登录
        </button>

        <view class="quick-actions">
          <text class="action-text" bindtap="quickFill">快速填写</text>
          <text class="action-text" bindtap="testMode">测试模式</text>
        </view>
      </view>
    </view>

    <!-- 其他登录方式（备用） -->
    <view class="other-methods" wx:if="{{activeTab === 'phone'}}">
      <view class="divider">
        <view class="divider-line"></view>
        <text class="divider-text">其他方式</text>
        <view class="divider-line"></view>
      </view>
      <view class="method-icons">
        <view class="method-icon" bindtap="switchTab" data-tab="wechat">
          <text>🟢</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 安全提示 -->
  <view class="security-tips">
    <text class="lock-icon">🔒</text>
    <text class="tip-text">你的数据安全由银行级加密保护</text>
  </view>

  <!-- 消息提示 -->
  <view class="toast {{toast.show ? 'show' : ''}}" wx:if="{{toast.show}}">
    <text>{{toast.message}}</text>
  </view>
</view>